#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

char key[] = "Cosmopolitan";
uint8_t secret[] = {0x34, 0x2a, 0x42, 0x0e, 0x00, 0x1d, 0x5c, 0x33, 0x5e, 0x44,
                    0x3e, 0x1a, 0x0b, 0x5c, 0x2c, 0x3a, 0x5f, 0x22, 0x03, 0x28,
                    0x36, 0x1b, 0x07, 0x31, 0x8d, 0xde, 0x10, 0xa2, 0xeb, 0xb2,
                    0xda, 0xa2, 0xd8, 0x18, 0x0d, 0x17, 0x1c, 0x1f, 0xbd, 0xd9,
                    0x1d, 0xbf, 0xeb, 0xa2, 0xd8, 0x16, 0x0d, 0xa0, 0xf6, 0x30,
                    0xbd, 0xd8, 0x17, 0xbe, 0xda, 0x0f, 0xab, 0xc1, 0xae, 0xea,
                    0x8d, 0xde, 0x11, 0x01, 0xa1, 0xc5};
// flag: TPCTF{wE1com3_70_tH3_W0RlD_of_αcτµαlly_pδrταblε_εxεcµταblε}

int main(int argc, char *argv[]) {
    char *flag = (char *)malloc(100);
    puts("Please input the flag:");
    scanf("%100s", flag);

    if (strlen(flag) != 73) {
    fail:
        puts("Incorrect! Try again.");
        return 0;
    }
    if (strncmp(flag, "TPCTF{", 6) != 0 || flag[72] != '}')
        goto fail;
    for (int i = 0; i < 66; i++) {
        if ((uint8_t)flag[i + 6] ^ (uint8_t)key[i % 12] ^ secret[i]) {
            goto fail;
        }
    }

    puts("Congratulations! You got the flag!");
    return 0;
}
